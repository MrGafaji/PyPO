\hypertarget{GUtils_8h_source}{}\doxysection{GUtils.\+h}
\label{GUtils_8h_source}\index{src/include/GUtils.h@{src/include/GUtils.h}}
\mbox{\hyperlink{GUtils_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#include <cuda.h>}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <cuComplex.h>}}
\DoxyCodeLine{4 }
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{comment}{// The Utils file contains mostly linear algebra functions as CUDA device functions}}
\DoxyCodeLine{7 \textcolor{comment}{// File contains overloads for doubles and floats}}
\DoxyCodeLine{8 \textcolor{comment}{// In GUtils, we use CUDA complex library for arithmetic.}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{comment}{// Real dot-\/product}}
\DoxyCodeLine{11 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(\textcolor{keywordtype}{double} (\&v1)[3], \textcolor{keywordtype}{double} (\&v2)[3], \textcolor{keywordtype}{double} \&out)}
\DoxyCodeLine{12 \{}
\DoxyCodeLine{13     out = 0;}
\DoxyCodeLine{14 }
\DoxyCodeLine{15     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{16     \{}
\DoxyCodeLine{17         out += v1[n] * v2[n];}
\DoxyCodeLine{18     \}}
\DoxyCodeLine{19 \}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{comment}{// Complex hermitian conjugate inner-\/product}}
\DoxyCodeLine{23 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(cuDoubleComplex (\&cv1)[3], cuDoubleComplex (\&cv2)[3], cuDoubleComplex \&out)}
\DoxyCodeLine{24 \{}
\DoxyCodeLine{25     out = make\_cuDoubleComplex(0, 0);}
\DoxyCodeLine{26 }
\DoxyCodeLine{27     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{28     \{}
\DoxyCodeLine{29         out = cuCadd(cuCmul(cuConj(cv1[n]), cv2[n]), out);}
\DoxyCodeLine{30     \}}
\DoxyCodeLine{31 \}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{comment}{// Complex vector -\/ real vector dot-\/product}}
\DoxyCodeLine{34 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(cuDoubleComplex (\&cv1)[3], \textcolor{keywordtype}{double} (\&v2)[3], cuDoubleComplex \&out)}
\DoxyCodeLine{35 \{}
\DoxyCodeLine{36     out = make\_cuDoubleComplex(0, 0);}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{39     \{}
\DoxyCodeLine{40         out = cuCadd(cuCmul(cuConj(cv1[n]), make\_cuDoubleComplex(v2[n], 0)), out);}
\DoxyCodeLine{41     \}}
\DoxyCodeLine{42 \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{comment}{// Real vector -\/ complex vector dot-\/product}}
\DoxyCodeLine{45 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(\textcolor{keywordtype}{double} (\&v1)[3], cuDoubleComplex (\&cv2)[3], cuDoubleComplex \&out)}
\DoxyCodeLine{46 \{}
\DoxyCodeLine{47     out = make\_cuDoubleComplex(0, 0);}
\DoxyCodeLine{48 }
\DoxyCodeLine{49     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{50     \{}
\DoxyCodeLine{51         out = cuCadd(cuCmul(make\_cuDoubleComplex(v1[n], 0), cv2[n]), out);}
\DoxyCodeLine{52     \}}
\DoxyCodeLine{53 \}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{comment}{// Real cross-\/product}}
\DoxyCodeLine{56 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a02e5acf4b7e1813975e8fd2a4a5b8d86}{ext}}(\textcolor{keywordtype}{double} (\&v1)[3], \textcolor{keywordtype}{double} (\&v2)[3], \textcolor{keywordtype}{double} (\&out)[3])}
\DoxyCodeLine{57 \{}
\DoxyCodeLine{58     out[0] = v1[1]*v2[2] -\/ v1[2]*v2[1];}
\DoxyCodeLine{59     out[1] = v1[2]*v2[0] -\/ v1[0]*v2[2];}
\DoxyCodeLine{60     out[2] = v1[0]*v2[1] -\/ v1[1]*v2[0];}
\DoxyCodeLine{61 \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 }
\DoxyCodeLine{64 \textcolor{comment}{// Complex conjugate of cross product}}
\DoxyCodeLine{65 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a02e5acf4b7e1813975e8fd2a4a5b8d86}{ext}}(cuDoubleComplex (\&cv1)[3], cuDoubleComplex (\&cv2)[3], cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{66 \{}
\DoxyCodeLine{67     out[0] = cuCsub(cuCmul(cv1[1], cv2[2]), cuCmul(cv1[2], cv2[1]));}
\DoxyCodeLine{68     out[1] = cuCsub(cuCmul(cv1[2], cv2[0]), cuCmul(cv1[0], cv2[2]));}
\DoxyCodeLine{69     out[2] = cuCsub(cuCmul(cv1[0], cv2[1]), cuCmul(cv1[1], cv2[0]));}
\DoxyCodeLine{70 \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \textcolor{comment}{// Cross product between an complex and a real vector}}
\DoxyCodeLine{73 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a02e5acf4b7e1813975e8fd2a4a5b8d86}{ext}}(cuDoubleComplex (\&cv1)[3], \textcolor{keywordtype}{double} (\&v2)[3], cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{74 \{}
\DoxyCodeLine{75     out[0] = cuCsub(cuCmul(cv1[1], make\_cuDoubleComplex(v2[2],0)), cuCmul(cv1[2], make\_cuDoubleComplex(v2[1],0)));}
\DoxyCodeLine{76     out[1] = cuCsub(cuCmul(cv1[2], make\_cuDoubleComplex(v2[0],0)), cuCmul(cv1[0], make\_cuDoubleComplex(v2[2],0)));}
\DoxyCodeLine{77     out[2] = cuCsub(cuCmul(cv1[0], make\_cuDoubleComplex(v2[1],0)), cuCmul(cv1[1], make\_cuDoubleComplex(v2[0],0)));}
\DoxyCodeLine{78 \}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80 \textcolor{comment}{// Cross product between a real vector and a complex vector}}
\DoxyCodeLine{81 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a02e5acf4b7e1813975e8fd2a4a5b8d86}{ext}}(\textcolor{keywordtype}{double} (\&v1)[3], cuDoubleComplex (\&cv2)[3], cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{82 \{}
\DoxyCodeLine{83     out[0] = cuCsub(cuCmul(make\_cuDoubleComplex(v1[1],0), cv2[2]), cuCmul(make\_cuDoubleComplex(v1[2],0), cv2[1]));}
\DoxyCodeLine{84     out[1] = cuCsub(cuCmul(make\_cuDoubleComplex(v1[2],0), cv2[0]), cuCmul(make\_cuDoubleComplex(v1[0],0), cv2[2]));}
\DoxyCodeLine{85     out[2] = cuCsub(cuCmul(make\_cuDoubleComplex(v1[0],0), cv2[1]), cuCmul(make\_cuDoubleComplex(v1[1],0), cv2[0]));}
\DoxyCodeLine{86 \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88 \textcolor{comment}{// Difference between two real vectors}}
\DoxyCodeLine{89 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a07679357f2349bfa8a26447ac2588346}{diff}}(\textcolor{keywordtype}{double} (\&v1)[3], \textcolor{keywordtype}{double} (\&v2)[3], \textcolor{keywordtype}{double} (\&out)[3])}
\DoxyCodeLine{90 \{}
\DoxyCodeLine{91     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{92     \{}
\DoxyCodeLine{93         out[n] = v1[n] -\/ v2[n];}
\DoxyCodeLine{94     \}}
\DoxyCodeLine{95 \}}
\DoxyCodeLine{96 }
\DoxyCodeLine{97 \textcolor{comment}{// Difference between two complex valued vectors}}
\DoxyCodeLine{98 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a07679357f2349bfa8a26447ac2588346}{diff}}(cuDoubleComplex (\&cv1)[3], cuDoubleComplex (\&cv2)[3], cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{99 \{}
\DoxyCodeLine{100     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{101     \{}
\DoxyCodeLine{102         out[n] = cuCsub(cv1[n], cv2[n]);}
\DoxyCodeLine{103     \}}
\DoxyCodeLine{104 \}}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 \textcolor{comment}{// Absolute value of real vector}}
\DoxyCodeLine{107 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a3423e96e5c144c7ca4f19758c4ce6eaf}{abs}}(\textcolor{keywordtype}{double} (\&v)[3], \textcolor{keywordtype}{double} \&out)}
\DoxyCodeLine{108 \{}
\DoxyCodeLine{109     \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(v, v, out);}
\DoxyCodeLine{110     out = sqrt(out);}
\DoxyCodeLine{111 \}}
\DoxyCodeLine{112 \textcolor{comment}{// Return complex conjugate of complex vector}}
\DoxyCodeLine{113 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_aa0df48c7c10bf94415d9503fb2942536}{conja}}(cuDoubleComplex (\&cv)[3], cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{114 \{}
\DoxyCodeLine{115     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{116     \{}
\DoxyCodeLine{117         out[n] = cuConj(cv[n]);}
\DoxyCodeLine{118     \}}
\DoxyCodeLine{119 \}}
\DoxyCodeLine{120 \textcolor{comment}{// Absolute value of a complex vector. Still returns a complex number!}}
\DoxyCodeLine{121 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a3423e96e5c144c7ca4f19758c4ce6eaf}{abs}}(cuDoubleComplex (\&cv)[3], cuDoubleComplex \&out)}
\DoxyCodeLine{122 \{}
\DoxyCodeLine{123     cuDoubleComplex cv\_conj[3];}
\DoxyCodeLine{124     \mbox{\hyperlink{GUtils_8h_aa0df48c7c10bf94415d9503fb2942536}{conja}}(cv, cv\_conj);}
\DoxyCodeLine{125     \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(cv, cv\_conj, out);}
\DoxyCodeLine{126     out = make\_cuDoubleComplex(cuCabs(out), 0);}
\DoxyCodeLine{127 \}}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 \textcolor{comment}{// Return normalized real vector from vector}}
\DoxyCodeLine{130 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a8523352448ad277475f786c719a7e70e}{normalize}}(\textcolor{keywordtype}{double} (\&v)[3], \textcolor{keywordtype}{double} (\&out)[3])}
\DoxyCodeLine{131 \{}
\DoxyCodeLine{132     \textcolor{keywordtype}{double} norm;}
\DoxyCodeLine{133     \mbox{\hyperlink{GUtils_8h_a3423e96e5c144c7ca4f19758c4ce6eaf}{abs}}(v, norm);}
\DoxyCodeLine{134 }
\DoxyCodeLine{135     \textcolor{keywordflow}{if} (norm == 0)}
\DoxyCodeLine{136     \{}
\DoxyCodeLine{137         norm = 1;}
\DoxyCodeLine{138     \}}
\DoxyCodeLine{139 }
\DoxyCodeLine{140     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{141     \{}
\DoxyCodeLine{142         out[n] = v[n] / norm;}
\DoxyCodeLine{143     \}}
\DoxyCodeLine{144 \}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \textcolor{comment}{// Normalize complex vector}}
\DoxyCodeLine{147 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a8523352448ad277475f786c719a7e70e}{normalize}}(cuDoubleComplex (\&cv)[3], cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{148 \{}
\DoxyCodeLine{149     cuDoubleComplex cnorm;}
\DoxyCodeLine{150     \mbox{\hyperlink{GUtils_8h_a3423e96e5c144c7ca4f19758c4ce6eaf}{abs}}(cv, cnorm);}
\DoxyCodeLine{151 }
\DoxyCodeLine{152     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{153     \{}
\DoxyCodeLine{154         out[n] = cuCdiv(cv[n], cnorm);}
\DoxyCodeLine{155     \}}
\DoxyCodeLine{156 \}}
\DoxyCodeLine{157 }
\DoxyCodeLine{158 \textcolor{comment}{// Apply standard real s-\/multiplication on a real vector}}
\DoxyCodeLine{159 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(\textcolor{keywordtype}{double} (\&v)[3], \textcolor{keywordtype}{double} \&s, \textcolor{keywordtype}{double} (\&out)[3])}
\DoxyCodeLine{160 \{}
\DoxyCodeLine{161     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{162     \{}
\DoxyCodeLine{163         out[n] = s * v[n];}
\DoxyCodeLine{164     \}}
\DoxyCodeLine{165 \}}
\DoxyCodeLine{166 }
\DoxyCodeLine{167 }
\DoxyCodeLine{168 \textcolor{comment}{// Multiply complex vector by complex scalar}}
\DoxyCodeLine{169 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(cuDoubleComplex (\&cv)[3], cuDoubleComplex \&cs, cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{170 \{}
\DoxyCodeLine{171     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{172     \{}
\DoxyCodeLine{173         out[n] = cuCmul(cs, cv[n]);}
\DoxyCodeLine{174     \}}
\DoxyCodeLine{175 \}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 \textcolor{comment}{// Multiply real vector by complex scalar}}
\DoxyCodeLine{178 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(\textcolor{keywordtype}{double} (\&v)[3], cuDoubleComplex \&cs, cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{179 \{}
\DoxyCodeLine{180     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{181     \{}
\DoxyCodeLine{182         out[n] = cuCmul(cs, make\_cuDoubleComplex(v[n],0));}
\DoxyCodeLine{183     \}}
\DoxyCodeLine{184 \}}
\DoxyCodeLine{185 }
\DoxyCodeLine{186 \textcolor{comment}{// Multiply complex vector by real scalar}}
\DoxyCodeLine{187 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(cuDoubleComplex (\&cv)[3], \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&s, cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{188 \{}
\DoxyCodeLine{189     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{190     \{}
\DoxyCodeLine{191         out[n] = cuCmul(make\_cuDoubleComplex(s,0), cv[n]);}
\DoxyCodeLine{192     \}}
\DoxyCodeLine{193 \}}
\DoxyCodeLine{194 }
\DoxyCodeLine{195 \textcolor{comment}{// Calculate refected vector from surface using complex incoming vector and real normal vector to surface}}
\DoxyCodeLine{196 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a66d191b458ca22b278008ed78f6afffe}{snell}}(cuDoubleComplex (\&cvin)[3], \textcolor{keywordtype}{double} (\&normal)[3], cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{197 \{}
\DoxyCodeLine{198     cuDoubleComplex cfactor;}
\DoxyCodeLine{199     \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(cvin, normal, cfactor);}
\DoxyCodeLine{200 }
\DoxyCodeLine{201     cfactor = cuCmul(make\_cuDoubleComplex(2.,0), cfactor);}
\DoxyCodeLine{202 }
\DoxyCodeLine{203     cuDoubleComplex rhs[3];}
\DoxyCodeLine{204     \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(normal, cfactor, rhs);}
\DoxyCodeLine{205 }
\DoxyCodeLine{206     \mbox{\hyperlink{GUtils_8h_a07679357f2349bfa8a26447ac2588346}{diff}}(cvin, rhs, out);}
\DoxyCodeLine{207 \}}
\DoxyCodeLine{208 }
\DoxyCodeLine{209 \textcolor{comment}{// Calculate refected vector from surface using complex incoming vector and real normal vector to surface}}
\DoxyCodeLine{210 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a66d191b458ca22b278008ed78f6afffe}{snell}}(\textcolor{keywordtype}{double} (\&vin)[3], \textcolor{keywordtype}{double} (\&normal)[3], \textcolor{keywordtype}{double} (\&out)[3])}
\DoxyCodeLine{211 \{}
\DoxyCodeLine{212     \textcolor{keywordtype}{double} factor;}
\DoxyCodeLine{213     \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(vin, normal, factor);}
\DoxyCodeLine{214 }
\DoxyCodeLine{215     factor = 2. * factor;}
\DoxyCodeLine{216 }
\DoxyCodeLine{217     \textcolor{keywordtype}{double} rhs[3];}
\DoxyCodeLine{218     \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(normal, factor, rhs);}
\DoxyCodeLine{219 }
\DoxyCodeLine{220     \mbox{\hyperlink{GUtils_8h_a07679357f2349bfa8a26447ac2588346}{diff}}(vin, rhs, out);}
\DoxyCodeLine{221 \}}
\DoxyCodeLine{222 }
\DoxyCodeLine{223 \textcolor{comment}{// Calculate Dyadic product between two real vectors}}
\DoxyCodeLine{224 \textcolor{comment}{// Returns array of length 3, containing 3 arrays representing ROWS in the resulting matrix}}
\DoxyCodeLine{225 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_aedb71448660b055bfc03fc1084b05f6e}{dyad}}(\textcolor{keywordtype}{double} (\&v1)[3], \textcolor{keywordtype}{double} (\&v2)[3], \textcolor{keywordtype}{double} (\&out)[3][3])}
\DoxyCodeLine{226 \{}
\DoxyCodeLine{227     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{228     \{}
\DoxyCodeLine{229         out[n][0] = v1[n] * v2[0];}
\DoxyCodeLine{230         out[n][1] = v1[n] * v2[1];}
\DoxyCodeLine{231         out[n][2] = v1[n] * v2[2];}
\DoxyCodeLine{232     \}}
\DoxyCodeLine{233 \}}
\DoxyCodeLine{234 }
\DoxyCodeLine{235 \textcolor{comment}{// Subtract matrix from another matrix element-\/wise}}
\DoxyCodeLine{236 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a52240ae6388dfa4cb884fa3dd97a5da9}{matDiff}}(\textcolor{keywordtype}{double} (\&m1)[3][3], \textcolor{keywordtype}{double} (\&m2)[3][3], \textcolor{keywordtype}{double} (\&out)[3][3])}
\DoxyCodeLine{237 \{}
\DoxyCodeLine{238     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{239     \{}
\DoxyCodeLine{240         out[n][0] = m1[n][0] -\/ m2[n][0];}
\DoxyCodeLine{241         out[n][1] = m1[n][1] -\/ m2[n][1];}
\DoxyCodeLine{242         out[n][2] = m1[n][2] -\/ m2[n][2];}
\DoxyCodeLine{243     \}}
\DoxyCodeLine{244 \}}
\DoxyCodeLine{245 }
\DoxyCodeLine{246 \textcolor{comment}{// Multiply matrix with vector to return vector}}
\DoxyCodeLine{247 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a81331cb9918bfbd42b759df8fb91fdcb}{matVec}}(\textcolor{keywordtype}{double} (\&m1)[3][3], \textcolor{keywordtype}{double} (\&v1)[3], \textcolor{keywordtype}{double} (\&out)[3])}
\DoxyCodeLine{248 \{}
\DoxyCodeLine{249     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{250     \{}
\DoxyCodeLine{251         out[n] = m1[n][0] * v1[0] + m1[n][1] * v1[1] + m1[n][2] * v1[2];}
\DoxyCodeLine{252     \}}
\DoxyCodeLine{253 \}}
\DoxyCodeLine{254 }
\DoxyCodeLine{255 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a81331cb9918bfbd42b759df8fb91fdcb}{matVec}}(\textcolor{keywordtype}{double} (\&m1)[3][3], cuDoubleComplex (\&cv1)[3], cuDoubleComplex (\&out)[3])}
\DoxyCodeLine{256 \{}
\DoxyCodeLine{257     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{258     \{}
\DoxyCodeLine{259         out[n] = cuCadd(cuCmul(make\_cuDoubleComplex(m1[n][0],0), cv1[0]),}
\DoxyCodeLine{260                 cuCadd(cuCmul(make\_cuDoubleComplex(m1[n][1],0), cv1[1]),}
\DoxyCodeLine{261                 cuCmul(make\_cuDoubleComplex(m1[n][2],0), cv1[2])));}
\DoxyCodeLine{262     \}}
\DoxyCodeLine{263 \}}
\DoxyCodeLine{264 }
\DoxyCodeLine{265 \textcolor{comment}{// OVERLOADS FOR FLOAT}}
\DoxyCodeLine{266 }
\DoxyCodeLine{267 \textcolor{comment}{// Real dot-\/product}}
\DoxyCodeLine{268 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(\textcolor{keywordtype}{float} (\&v1)[3], \textcolor{keywordtype}{float} (\&v2)[3], \textcolor{keywordtype}{float} \&out)}
\DoxyCodeLine{269 \{}
\DoxyCodeLine{270     out = 0;}
\DoxyCodeLine{271 }
\DoxyCodeLine{272     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{273     \{}
\DoxyCodeLine{274         out += v1[n] * v2[n];}
\DoxyCodeLine{275     \}}
\DoxyCodeLine{276 \}}
\DoxyCodeLine{277 }
\DoxyCodeLine{278 }
\DoxyCodeLine{279 \textcolor{comment}{// Complex hermitian conjugate inner-\/product}}
\DoxyCodeLine{280 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(cuFloatComplex (\&cv1)[3], cuFloatComplex (\&cv2)[3], cuFloatComplex \&out)}
\DoxyCodeLine{281 \{}
\DoxyCodeLine{282     out = make\_cuFloatComplex(0, 0);}
\DoxyCodeLine{283 }
\DoxyCodeLine{284     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{285     \{}
\DoxyCodeLine{286         out = cuCaddf(cuCmulf(cuConjf(cv1[n]), cv2[n]), out);}
\DoxyCodeLine{287     \}}
\DoxyCodeLine{288 \}}
\DoxyCodeLine{289 }
\DoxyCodeLine{290 \textcolor{comment}{// Complex vector -\/ real vector dot-\/product}}
\DoxyCodeLine{291 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(cuFloatComplex (\&cv1)[3], \textcolor{keywordtype}{float} (\&v2)[3], cuFloatComplex \&out)}
\DoxyCodeLine{292 \{}
\DoxyCodeLine{293     out = make\_cuFloatComplex(0, 0);}
\DoxyCodeLine{294 }
\DoxyCodeLine{295     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{296     \{}
\DoxyCodeLine{297         out = cuCaddf(cuCmulf(cuConjf(cv1[n]), make\_cuFloatComplex(v2[n], 0)), out);}
\DoxyCodeLine{298     \}}
\DoxyCodeLine{299 \}}
\DoxyCodeLine{300 }
\DoxyCodeLine{301 \textcolor{comment}{// Real vector -\/ complex vector dot-\/product}}
\DoxyCodeLine{302 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(\textcolor{keywordtype}{float} (\&v1)[3], cuFloatComplex (\&cv2)[3], cuFloatComplex \&out)}
\DoxyCodeLine{303 \{}
\DoxyCodeLine{304     out = make\_cuFloatComplex(0, 0);}
\DoxyCodeLine{305 }
\DoxyCodeLine{306     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{307     \{}
\DoxyCodeLine{308         out = cuCaddf(cuCmulf(make\_cuFloatComplex(v1[n], 0), cv2[n]), out);}
\DoxyCodeLine{309     \}}
\DoxyCodeLine{310 \}}
\DoxyCodeLine{311 }
\DoxyCodeLine{312 \textcolor{comment}{// Real cross-\/product}}
\DoxyCodeLine{313 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a02e5acf4b7e1813975e8fd2a4a5b8d86}{ext}}(\textcolor{keywordtype}{float} (\&v1)[3], \textcolor{keywordtype}{float} (\&v2)[3], \textcolor{keywordtype}{float} (\&out)[3])}
\DoxyCodeLine{314 \{}
\DoxyCodeLine{315     out[0] = v1[1]*v2[2] -\/ v1[2]*v2[1];}
\DoxyCodeLine{316     out[1] = v1[2]*v2[0] -\/ v1[0]*v2[2];}
\DoxyCodeLine{317     out[2] = v1[0]*v2[1] -\/ v1[1]*v2[0];}
\DoxyCodeLine{318 \}}
\DoxyCodeLine{319 }
\DoxyCodeLine{320 }
\DoxyCodeLine{321 \textcolor{comment}{// Complex conjugate of cross product}}
\DoxyCodeLine{322 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a02e5acf4b7e1813975e8fd2a4a5b8d86}{ext}}(cuFloatComplex (\&cv1)[3], cuFloatComplex (\&cv2)[3], cuFloatComplex (\&out)[3])}
\DoxyCodeLine{323 \{}
\DoxyCodeLine{324     out[0] = cuCsubf(cuCmulf(cv1[1], cv2[2]), cuCmulf(cv1[2], cv2[1]));}
\DoxyCodeLine{325     out[1] = cuCsubf(cuCmulf(cv1[2], cv2[0]), cuCmulf(cv1[0], cv2[2]));}
\DoxyCodeLine{326     out[2] = cuCsubf(cuCmulf(cv1[0], cv2[1]), cuCmulf(cv1[1], cv2[0]));}
\DoxyCodeLine{327 \}}
\DoxyCodeLine{328 }
\DoxyCodeLine{329 \textcolor{comment}{// Cross product between an complex and a real vector}}
\DoxyCodeLine{330 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a02e5acf4b7e1813975e8fd2a4a5b8d86}{ext}}(cuFloatComplex (\&cv1)[3], \textcolor{keywordtype}{float} (\&v2)[3], cuFloatComplex (\&out)[3])}
\DoxyCodeLine{331 \{}
\DoxyCodeLine{332     out[0] = cuCsubf(cuCmulf(cv1[1], make\_cuFloatComplex(v2[2],0)), cuCmulf(cv1[2], make\_cuFloatComplex(v2[1],0)));}
\DoxyCodeLine{333     out[1] = cuCsubf(cuCmulf(cv1[2], make\_cuFloatComplex(v2[0],0)), cuCmulf(cv1[0], make\_cuFloatComplex(v2[2],0)));}
\DoxyCodeLine{334     out[2] = cuCsubf(cuCmulf(cv1[0], make\_cuFloatComplex(v2[1],0)), cuCmulf(cv1[1], make\_cuFloatComplex(v2[0],0)));}
\DoxyCodeLine{335 \}}
\DoxyCodeLine{336 }
\DoxyCodeLine{337 \textcolor{comment}{// Cross product between a real vector and a complex vector}}
\DoxyCodeLine{338 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a02e5acf4b7e1813975e8fd2a4a5b8d86}{ext}}(\textcolor{keywordtype}{float} (\&v1)[3], cuFloatComplex (\&cv2)[3], cuFloatComplex (\&out)[3])}
\DoxyCodeLine{339 \{}
\DoxyCodeLine{340     out[0] = cuCsubf(cuCmulf(make\_cuFloatComplex(v1[1],0), cv2[2]), cuCmulf(make\_cuFloatComplex(v1[2],0), cv2[1]));}
\DoxyCodeLine{341     out[1] = cuCsubf(cuCmulf(make\_cuFloatComplex(v1[2],0), cv2[0]), cuCmulf(make\_cuFloatComplex(v1[0],0), cv2[2]));}
\DoxyCodeLine{342     out[2] = cuCsubf(cuCmulf(make\_cuFloatComplex(v1[0],0), cv2[1]), cuCmulf(make\_cuFloatComplex(v1[1],0), cv2[0]));}
\DoxyCodeLine{343 \}}
\DoxyCodeLine{344 }
\DoxyCodeLine{345 \textcolor{comment}{// Difference between two real vectors}}
\DoxyCodeLine{346 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a07679357f2349bfa8a26447ac2588346}{diff}}(\textcolor{keywordtype}{float} (\&v1)[3], \textcolor{keywordtype}{float} (\&v2)[3], \textcolor{keywordtype}{float} (\&out)[3])}
\DoxyCodeLine{347 \{}
\DoxyCodeLine{348     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{349     \{}
\DoxyCodeLine{350         out[n] = v1[n] -\/ v2[n];}
\DoxyCodeLine{351     \}}
\DoxyCodeLine{352 \}}
\DoxyCodeLine{353 }
\DoxyCodeLine{354 \textcolor{comment}{// Difference between two complex valued vectors}}
\DoxyCodeLine{355 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a07679357f2349bfa8a26447ac2588346}{diff}}(cuFloatComplex (\&cv1)[3], cuFloatComplex (\&cv2)[3], cuFloatComplex (\&out)[3])}
\DoxyCodeLine{356 \{}
\DoxyCodeLine{357     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{358     \{}
\DoxyCodeLine{359         out[n] = cuCsubf(cv1[n], cv2[n]);}
\DoxyCodeLine{360     \}}
\DoxyCodeLine{361 \}}
\DoxyCodeLine{362 }
\DoxyCodeLine{363 \textcolor{comment}{// Absolute value of real vector}}
\DoxyCodeLine{364 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a3423e96e5c144c7ca4f19758c4ce6eaf}{abs}}(\textcolor{keywordtype}{float} (\&v)[3], \textcolor{keywordtype}{float} \&out)}
\DoxyCodeLine{365 \{}
\DoxyCodeLine{366     \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(v, v, out);}
\DoxyCodeLine{367     out = sqrt(out);}
\DoxyCodeLine{368 \}}
\DoxyCodeLine{369 \textcolor{comment}{// Return complex conjugate of complex vector}}
\DoxyCodeLine{370 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_aa0df48c7c10bf94415d9503fb2942536}{conja}}(cuFloatComplex (\&cv)[3], cuFloatComplex (\&out)[3])}
\DoxyCodeLine{371 \{}
\DoxyCodeLine{372     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{373     \{}
\DoxyCodeLine{374         out[n] = cuConjf(cv[n]);}
\DoxyCodeLine{375     \}}
\DoxyCodeLine{376 \}}
\DoxyCodeLine{377 \textcolor{comment}{// Absolute value of a complex vector. Still returns a complex number!}}
\DoxyCodeLine{378 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a3423e96e5c144c7ca4f19758c4ce6eaf}{abs}}(cuFloatComplex (\&cv)[3], cuFloatComplex \&out)}
\DoxyCodeLine{379 \{}
\DoxyCodeLine{380     cuFloatComplex cv\_conj[3];}
\DoxyCodeLine{381     \mbox{\hyperlink{GUtils_8h_aa0df48c7c10bf94415d9503fb2942536}{conja}}(cv, cv\_conj);}
\DoxyCodeLine{382     \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(cv, cv\_conj, out);}
\DoxyCodeLine{383     out = make\_cuFloatComplex(cuCabsf(out), 0);}
\DoxyCodeLine{384 \}}
\DoxyCodeLine{385 }
\DoxyCodeLine{386 \textcolor{comment}{// Return normalized real vector from vector}}
\DoxyCodeLine{387 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a8523352448ad277475f786c719a7e70e}{normalize}}(\textcolor{keywordtype}{float} (\&v)[3], \textcolor{keywordtype}{float} (\&out)[3])}
\DoxyCodeLine{388 \{}
\DoxyCodeLine{389     \textcolor{keywordtype}{float} norm;}
\DoxyCodeLine{390     \mbox{\hyperlink{GUtils_8h_a3423e96e5c144c7ca4f19758c4ce6eaf}{abs}}(v, norm);}
\DoxyCodeLine{391 }
\DoxyCodeLine{392 }
\DoxyCodeLine{393     \textcolor{keywordflow}{if} (norm == 0)}
\DoxyCodeLine{394     \{}
\DoxyCodeLine{395         norm = 1;}
\DoxyCodeLine{396     \}}
\DoxyCodeLine{397 }
\DoxyCodeLine{398     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{399     \{}
\DoxyCodeLine{400         out[n] = v[n] / norm;}
\DoxyCodeLine{401     \}}
\DoxyCodeLine{402 \}}
\DoxyCodeLine{403 }
\DoxyCodeLine{404 \textcolor{comment}{// Normalize complex vector}}
\DoxyCodeLine{405 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a8523352448ad277475f786c719a7e70e}{normalize}}(cuFloatComplex (\&cv)[3], cuFloatComplex (\&out)[3])}
\DoxyCodeLine{406 \{}
\DoxyCodeLine{407     cuFloatComplex cnorm;}
\DoxyCodeLine{408     \mbox{\hyperlink{GUtils_8h_a3423e96e5c144c7ca4f19758c4ce6eaf}{abs}}(cv, cnorm);}
\DoxyCodeLine{409 }
\DoxyCodeLine{410     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{411     \{}
\DoxyCodeLine{412         out[n] = cuCdivf(cv[n], cnorm);}
\DoxyCodeLine{413     \}}
\DoxyCodeLine{414 \}}
\DoxyCodeLine{415 }
\DoxyCodeLine{416 \textcolor{comment}{// Apply standard real s-\/multiplication on a real vector}}
\DoxyCodeLine{417 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(\textcolor{keywordtype}{float} (\&v)[3], \textcolor{keywordtype}{float} \&s, \textcolor{keywordtype}{float} (\&out)[3])}
\DoxyCodeLine{418 \{}
\DoxyCodeLine{419     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{420     \{}
\DoxyCodeLine{421         out[n] = s * v[n];}
\DoxyCodeLine{422     \}}
\DoxyCodeLine{423 \}}
\DoxyCodeLine{424 }
\DoxyCodeLine{425 }
\DoxyCodeLine{426 \textcolor{comment}{// Multiply complex vector by complex scalar}}
\DoxyCodeLine{427 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(cuFloatComplex (\&cv)[3], cuFloatComplex \&cs, cuFloatComplex (\&out)[3])}
\DoxyCodeLine{428 \{}
\DoxyCodeLine{429     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{430     \{}
\DoxyCodeLine{431         out[n] = cuCmulf(cs, cv[n]);}
\DoxyCodeLine{432     \}}
\DoxyCodeLine{433 \}}
\DoxyCodeLine{434 }
\DoxyCodeLine{435 \textcolor{comment}{// Multiply real vector by complex scalar}}
\DoxyCodeLine{436 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(\textcolor{keywordtype}{float} (\&v)[3], cuFloatComplex \&cs, cuFloatComplex (\&out)[3])}
\DoxyCodeLine{437 \{}
\DoxyCodeLine{438     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{439     \{}
\DoxyCodeLine{440         out[n] = cuCmulf(cs, make\_cuFloatComplex(v[n],0));}
\DoxyCodeLine{441     \}}
\DoxyCodeLine{442 \}}
\DoxyCodeLine{443 }
\DoxyCodeLine{444 \textcolor{comment}{// Multiply complex vector by real scalar}}
\DoxyCodeLine{445 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(cuFloatComplex (\&cv)[3], \textcolor{keyword}{const} \textcolor{keywordtype}{float} \&s, cuFloatComplex (\&out)[3])}
\DoxyCodeLine{446 \{}
\DoxyCodeLine{447     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{448     \{}
\DoxyCodeLine{449         out[n] = cuCmulf(make\_cuFloatComplex(s,0), cv[n]);}
\DoxyCodeLine{450     \}}
\DoxyCodeLine{451 \}}
\DoxyCodeLine{452 }
\DoxyCodeLine{453 \textcolor{comment}{// Calculate refected vector from surface using complex incoming vector and real normal vector to surface}}
\DoxyCodeLine{454 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a66d191b458ca22b278008ed78f6afffe}{snell}}(cuFloatComplex (\&cvin)[3], \textcolor{keywordtype}{float} (\&normal)[3], cuFloatComplex (\&out)[3])}
\DoxyCodeLine{455 \{}
\DoxyCodeLine{456     cuFloatComplex cfactor;}
\DoxyCodeLine{457     \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(cvin, normal, cfactor);}
\DoxyCodeLine{458 }
\DoxyCodeLine{459     cfactor = cuCmulf(make\_cuFloatComplex(2.,0), cfactor);}
\DoxyCodeLine{460 }
\DoxyCodeLine{461     cuFloatComplex rhs[3];}
\DoxyCodeLine{462     \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(normal, cfactor, rhs);}
\DoxyCodeLine{463 }
\DoxyCodeLine{464     \mbox{\hyperlink{GUtils_8h_a07679357f2349bfa8a26447ac2588346}{diff}}(cvin, rhs, out);}
\DoxyCodeLine{465 \}}
\DoxyCodeLine{466 }
\DoxyCodeLine{467 \textcolor{comment}{// Calculate refected vector from surface using complex incoming vector and real normal vector to surface}}
\DoxyCodeLine{468 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a66d191b458ca22b278008ed78f6afffe}{snell}}(\textcolor{keywordtype}{float} (\&vin)[3], \textcolor{keywordtype}{float} (\&normal)[3], \textcolor{keywordtype}{float} (\&out)[3])}
\DoxyCodeLine{469 \{}
\DoxyCodeLine{470     \textcolor{keywordtype}{float} factor;}
\DoxyCodeLine{471     \mbox{\hyperlink{GUtils_8h_a76655de2eb96741171f578c18355af87}{dot}}(vin, normal, factor);}
\DoxyCodeLine{472 }
\DoxyCodeLine{473     factor = 2. * factor;}
\DoxyCodeLine{474 }
\DoxyCodeLine{475     \textcolor{keywordtype}{float} rhs[3];}
\DoxyCodeLine{476     \mbox{\hyperlink{GUtils_8h_ab1fb947f22166aa8bb1f8f36bad597a9}{s\_mult}}(normal, factor, rhs);}
\DoxyCodeLine{477 }
\DoxyCodeLine{478     \mbox{\hyperlink{GUtils_8h_a07679357f2349bfa8a26447ac2588346}{diff}}(vin, rhs, out);}
\DoxyCodeLine{479 \}}
\DoxyCodeLine{480 }
\DoxyCodeLine{481 \textcolor{comment}{// Calculate Dyadic product between two real vectors}}
\DoxyCodeLine{482 \textcolor{comment}{// Returns array of length 3, containing 3 arrays representing ROWS in the resulting matrix}}
\DoxyCodeLine{483 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_aedb71448660b055bfc03fc1084b05f6e}{dyad}}(\textcolor{keywordtype}{float} (\&v1)[3], \textcolor{keywordtype}{float} (\&v2)[3], \textcolor{keywordtype}{float} (\&out)[3][3])}
\DoxyCodeLine{484 \{}
\DoxyCodeLine{485     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{486     \{}
\DoxyCodeLine{487         out[n][0] = v1[n] * v2[0];}
\DoxyCodeLine{488         out[n][1] = v1[n] * v2[1];}
\DoxyCodeLine{489         out[n][2] = v1[n] * v2[2];}
\DoxyCodeLine{490     \}}
\DoxyCodeLine{491 \}}
\DoxyCodeLine{492 }
\DoxyCodeLine{493 \textcolor{comment}{// Subtract matrix from another matrix element-\/wise}}
\DoxyCodeLine{494 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a52240ae6388dfa4cb884fa3dd97a5da9}{matDiff}}(\textcolor{keywordtype}{float} (\&m1)[3][3], \textcolor{keywordtype}{float} (\&m2)[3][3], \textcolor{keywordtype}{float} (\&out)[3][3])}
\DoxyCodeLine{495 \{}
\DoxyCodeLine{496     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{497     \{}
\DoxyCodeLine{498         out[n][0] = m1[n][0] -\/ m2[n][0];}
\DoxyCodeLine{499         out[n][1] = m1[n][1] -\/ m2[n][1];}
\DoxyCodeLine{500         out[n][2] = m1[n][2] -\/ m2[n][2];}
\DoxyCodeLine{501     \}}
\DoxyCodeLine{502 \}}
\DoxyCodeLine{503 }
\DoxyCodeLine{504 \textcolor{comment}{// Multiply matrix with vector to return vector}}
\DoxyCodeLine{505 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a81331cb9918bfbd42b759df8fb91fdcb}{matVec}}(\textcolor{keywordtype}{float} (\&m1)[3][3], \textcolor{keywordtype}{float} (\&v1)[3], \textcolor{keywordtype}{float} (\&out)[3])}
\DoxyCodeLine{506 \{}
\DoxyCodeLine{507     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{508     \{}
\DoxyCodeLine{509         out[n] = m1[n][0] * v1[0] + m1[n][1] * v1[1] + m1[n][2] * v1[2];}
\DoxyCodeLine{510     \}}
\DoxyCodeLine{511 \}}
\DoxyCodeLine{512 }
\DoxyCodeLine{513 \_\_device\_\_ \_\_inline\_\_ \textcolor{keywordtype}{void} \mbox{\hyperlink{GUtils_8h_a81331cb9918bfbd42b759df8fb91fdcb}{matVec}}(\textcolor{keywordtype}{float} (\&m1)[3][3], cuFloatComplex (\&cv1)[3], cuFloatComplex (\&out)[3])}
\DoxyCodeLine{514 \{}
\DoxyCodeLine{515     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} n=0; n<3; n++)}
\DoxyCodeLine{516     \{}
\DoxyCodeLine{517         out[n] = cuCaddf(cuCmulf(make\_cuFloatComplex(m1[n][0],0), cv1[0]),}
\DoxyCodeLine{518                 cuCaddf(cuCmulf(make\_cuFloatComplex(m1[n][1],0), cv1[1]),}
\DoxyCodeLine{519                 cuCmulf(make\_cuFloatComplex(m1[n][2],0), cv1[2])));}
\DoxyCodeLine{520     \}}
\DoxyCodeLine{521 \}}

\end{DoxyCode}
